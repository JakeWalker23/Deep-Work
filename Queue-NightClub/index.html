<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Queue Nightclub</title>

    <link rel="stylesheet" type="text/css" media="screen" href="style.css" />
    <link href="https://fonts.googleapis.com/css?family=Lobster+Two&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lobster|Lobster+Two&display=swap" rel="stylesheet">
    
    <script src="Queue.js" type="text/javascript"></script>
</head>
<body>
    <div class="title-box">
            <h1 class="club-title">Durley Nightclub</h1>
            <img class="disco-ball" src="/Assets/disco-ball.svg" height="30px" width="30px"/>
    </div>
    <div class="capacity">
        <audio id="music" src="Assets/50Cent.mp3" type="mp3"></audio>
        <h3 class="club-capacity">Club capacity: <span id="Capacity-Variable" value=130>10</span> </h3>

        <!--Need to dynamically insert the length of the Queue here.-->
        <h3 class="current-capacity">Current capacity: <span id="currentCapacity">0</span> </h3>
    </div>

    <div class="queue-output" id="queueContents">
        <p>Hello Queue Output </p>
    </div>

<!--Added buttons through html now. Seems to work better for updating the Queue-->
    <form class="form">
        <input id="updateField" type="input" class="update-field"></input>
        <input onclick="updateQueue()" id="updateBtn" type="button" value="Add" class="update-btn"></input>
            <br>  
        <input id="removeField" type="input"  class="remove-field"></input>
        <input onclick="removeQueue()"id="removeBtn" type="button" value="Remove" class="remove-btn"></input>
    </form>

<!--Adding the queue here because don't know how to import from a file.-->
    <script>
    // This should be in main.js! 
        let q = new Queue();
        q.add(3);
        q.add(100);        

        // Display the Queue
        function displayQueue() {
            let queueContents = document.getElementById("queueContents");
                queueContents.innerHTML = q.show();
                queueContents.style.fontSize = "25px";
        }

        displayQueue();

    // Add to the Queue
        function addQueue(value) {
            q.add(value)
        }

    // Remove from the Queue
        function removeQueue(value) {
            q.remove(value);
        }        

    // Add the buttons value of the input to the Queue on click
        updateBtn.addEventListener("click", function() {
            let val = document.getElementById("updateField").value
            console.log(val);
            if (val == 0) return false;          
            q.add(val);   
            document.getElementById("updateField").value = 0;

            capacityVariable = document.getElementById("Capacity-Variable").innerHTML;
            let numericalCapacityVariable = parseInt(capacityVariable);
                if (q.size >= numericalCapacityVariable) return false; 
            })

    // Remove the buttons value of the input to the Queue on click
        removeBtn.addEventListener("click", function() {
            removeQueue();
            document.getElementById("removeField").value = 0;
            //console.log(q);
        })

    // Display the current capacity to the DOM
        function currentCapacity() {
            let currentCapacity = document.getElementById("currentCapacity");
                currentCapacity.innerHTML = q.size()
                currentCapacity.style.fontFamily = "Lobster";
        }

        currentCapacity();

    // Update the current capacity of the DOM everytime the Queue size is changed.
        function updateCapacity() {
            setInterval(currentCapacity, 100)
        }

        updateCapacity()

    // Update the Queue on screen everytime the size changes.
        function updateQueue() {
            setInterval(displayQueue, 100)
        }

        updateQueue()

        function playMusic() {
            let music = document.getElementById("music");
            music.play();
        }

        playMusic();

        function stopMusic() {
            let music = document.getElementById("music");
            if (q.size() < 1) {
                music.stop();
            }
        }

        window.addEventListener("input" , function(e) {
            e.target.value = parseFloat(e.target.value) || 0;
        });  

        function test() {
            capacityVariable = document.getElementById("Capacity-Variable").innerHTML;
            let numericalCapacityVariable = parseInt(capacityVariable);
        }

        test();
        </script>
    </body>
</html>